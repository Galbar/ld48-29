<html>
<head>

	<script src="howler.js"></script>

	<script src="CanvasDye.js"></script>
	<script src="pixi.js"></script>
	<script src="Constants.js"></script>
	<script src="Cell.js"></script>
	<script src="Player.js"></script>
	<script src="Move.js"></script>
	<script src="Map.js"></script>
	<script src="Game.js"></script>

	<script src="PlayerSpriteController.js"></script>
	<script src="BlockSpriteController.js"></script>
	<script src="CellSpriteController.js"></script>
	<script src="MapSpriteController.js"></script>
	

	<style>

		body {
			margin: 0;
			padding: 0;
			background-color: #FF0000;
		}

	</style>

</head>
<body>

	<script>

	"POL-hard-corps-short.wav"

		/*
		var bgmusic = new Howl({
			urls: ['POL-hard-corps-short.wav'],
			autoplay: true,
			loop: true,
			volume: 0.5
		});
		*/
	
		var gaem = new Game();

		var sprites = [];

		for (var i = 0; i < 10; ++i) {

			var player = new Player();
			player.setRandomOrientation();
			if (i != 0) player.makeAI();
			var team = (i < 5? 0 : 1);
			gaem.addPlayerToTeam(player, team);

			var psc = new PlayerSpriteController(player);
			sprites.push(psc);
			psc.syncWithData();

		}

		var msc = new MapSpriteController(gaem.getMap());

		var stage = new PIXI.Stage(0xEEEEEE);
		stage.addChild(msc.getSprite());

		var renderer = PIXI.autoDetectRenderer(600, 400);

		window.onresize = function () {
			renderer.resize(window.innerWidth, window.innerHeight);
			msc.centerInRect(window.innerWidth, window.innerHeight);
		}
		window.onresize();

		document.body.appendChild(renderer.view);

		var oldDate = +new Date();
		function animate() {
		    requestAnimFrame(animate);

		    var newDate = +new Date();
		    //var dt = Math.min((newDate-oldDate)/16, 1.3); BRAKES EVERTHANG
		    var dt = 1;
		    oldDate = newDate;

		    msc.logic(dt);

		    // render the stage
		    renderer.render(stage);
		}

		requestAnimFrame(animate);

	</script>

</body>
</html>